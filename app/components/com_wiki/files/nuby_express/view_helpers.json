{"__v":1,"_id":"nuby_express:view_helpers","author":"bingomanatee","content":"View Helpers are a special class of resource.  Between execution of `on_output` and the rendering of your template, your output passes through all view filters.*\n\nEach filter can have an optional weight parameter. If present your filters will be executed in ascending order of weight; otherwise there is no guaranteeing which filter executes first. \n\n## View Helper API\n\nEach view helper must have an `init(rs, input, cb)` method through which the input is passed. The callback is designed to receive (err, input) but in reality, if you want to abort execution of a request it is best to do it directly by emitting an error or calling `rs.send()` or `rs.go()` directly. \n\n## A Sample View Filter\n\nThe following view helper aggregates the CSS configurations of the current stack into a client side property for the benefit of layouts:\n\n``` css\n\nvar NE = require('nuby-express');\nvar _ = require('underscore');\nvar util = require('util');\n\nmodule.exports = {\n    name: 'css',\n\n    init: function(rs, input, cb){\n\n        var  ln = rs.action.get_config('layout_name', 'NO LAYOUT')\n\n        if (ln == 'NO LAYOUT' ){\n            //console.log(' .... no layout for css: %s', ln);\n            var layout = false;\n        } else {\n           // console.log('input layout name:  css %s', ln);\n            var layout = rs.framework.get_resource('layout', ln);\n        }\n\n        var css = rs.action.get_config('css', input.css ? input.css : [], true);\n\n        if (layout && layout.config.css){\n            css = css.concat(layout.config.css);\n        } else if (layout){\n          //  console.log('no css in layout: %s', util.inspect(layout.config));\n        }\n\n        input.css = _.uniq(css);\n        cb(null, this.name);\n    }\n\n};\n\n```\n\n---------\n<small>* if you want your view filter to be more selective, you can use the [[req_state:Req_State]] to act selectively.</small>","creator":"bingomanatee","name":"view_helpers","scope":"nuby_express","summary":"View Helpers - input pre-processers","title":"View Helpers","write_date":"2012-10-22T01:57:48.631Z","scope_root":false,"deleted":false}